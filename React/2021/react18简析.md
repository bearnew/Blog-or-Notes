# React18

## 1.并发模式(`concurrent mode`)

1. 简介
   - 在`React 18`中加入了可选的并发渲染`concurrent rendering`机制
   - `Concurrent`模式是一组 React 的新功能，可帮助应用程序保持响应，并根据用户的设备性能和网速进行调整
   - 在`Concurrent`中渲染不是阻塞的，是可中断的
   - 在`react 17`也有并发模式，但是默认是同步渲染
2. 更新优先级
   - 以前更新没有优先级的概念，优先级高的更新并不能打断之前的更新，需要等前面的更新完成后才能进行
   - 用户对不同的操作对交互的执行速度有不同的预期，我们可以根据用户的预期赋予更新不同的优先级
     - 高优先级：用户输入、窗口缩放、拖拽事件
     - 低优先级：数据请求、下载文件
   - 高优先级的更新会中断正在进行的低优先级的更新
   - 等高优先级更新完成后，低优先级基于高优先级更新的结果重新更新
   - 对于`cpu-bound`的更新（例如创建新的 DOM 节点和运行组件中的代码），并发意味着一个更急迫的更新可以中断已经开始的渲染

## 2.双缓冲

1. 当数据量很大的时候，绘图可能需要几秒钟甚至更长的的时间，而且有时会出现闪烁现象，为了解决这些问题，可采用双缓冲技术来绘图
2. 双缓冲在内存中创建一个与屏幕绘图区域一致的的对象，先将图形绘制到内存中的这个对象上，再一次性将这个对象上的图形拷贝到屏幕上，加快绘图速度
3. 对于`IO-bound`的更新（例如从网络加载代码或者数据），并发意味着`React`甚至可以在全部数据到达之前就在内存中渲染，然后跳过空白加载状态
4. 因为只有 2 个缓冲区域，因此不会过度消耗内存
